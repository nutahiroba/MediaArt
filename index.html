<!DOCTYPE html>
<html>
  <head>
    <title>MediaArt by p5.js</title>
    <meta charset="utf-8">
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.js"></script>
    <script>
      let song,analyzer;
      function preload(){
        song=loadSound('パステルハウス.mp3');
      }
      function setup(){
        createCanvas(710,200);
        analyzer=new p5.Amplitude();
        const button=setButton('START',{
          x:40,
          y:180
        });
        button.mousePressed(()=>{
          if(song.isPlaying()){
            song.puse();
            button.html('LOOP');
          }else{
            song.loop();
            analyzer.setInput(song);
            button.html('PAUSE');
          }
        });
      }
      function draw(){
        background(255);
        let rms=analyzer.getLevel();
        fill(127);
        stroke(0);
        ellipse(width/2,height/2,10+rms*200,10+rms*200);
      }
      function setButton(label,pos){
        const button=createButton(label);
        button.size(100,30);
        button.position(pos.x,pos.y);
        return button;
      }
    </script>
  </body>
</html>